# 详细说一下Promise的用法

Promise，首先他是一个类，可以通过`new`关键字来生成一个promise实例，这个实例有三种状态，默认是`pending`，另外两个，一个是`fulfilled`表示成功，一个是`rejected`表示失败，状态的流转也是不可逆的。

当我们new一个Promise时，可以传入一个回调函数，这个回调函数是同步执行的，他接收两个参数，这两个参数都是回调函数。第一个参数是`resolve`，调用后，状态会切换为`成功`；第二个参数是`reject`，调用后状态会切换成`失败`。

promise实例可以调用`then`、`catch`和`finally`方法。首先then可以接收两个回调函数，第一个是状态为`成功`的时候执行，第二个是状态为`失败`的时候执行。

`catch`是如果前面没有对失败做处理，就会执行。

`finally`是不管成功还是失败，都会执行。

前面说的这三个都会继续返回一个新的promise，所以可以使用链式调用来处理；

另外，Promise也提供的一些函数用于处理多个异步任务的情况，比如`all`,`race`,`any`,`allSettled`。

`all`接收一个数组，元素可以是普通类型的数据，也可以是Promise对象，如果没有状态为拒绝的promise，就会返回一个数组，里面的顺序就是传入的顺序，如果有拒绝的promise，就会返回第一个拒绝的promise。

`race`也是接收一个数组，元素里面任何一个promise的状态有变化，就直接返回改promise的结果；

`any`也是接收一个数组，元素里面任何一个状态变成成功，就返回该成功promise的结果，如果全都失败，就返回一个`AggregateError`；

最后`allSettled`是不管成功还是失败，都会返回所有的结果。





